YUI.add("lang/wskey-app",function(a){a.Intl.add("wskey-app","",{"error":{"loadInsts":"Error loading institutions","wskeyPermissionDenied":"You do not have permission to view this WSkey","accessDenied":"Your account does not have access to this screen","accessDeniedProdRequest":"Your account does not have access to Request a Production WSKey","requestPermissionDenied":"You do not have permission to view this WSkey","accessDeniedWSKeys":"Your account does not have access to WSKeys","cannotAddInst":"Unable to add institution","accessDeniedQuotas":"Your account does not have access to Quotas","loadRequests":"Error loading requests","accessDeniedRequests":"Your account does not have access to Requests","accessDeniedSboxRequest":"Your account does not have access to Request a Sandbox WSKey","loadServices":"Error loading services","loadWSKeys":"Error loading keys","loadConfig":"Error loading configuration"},"addRegIdPrompt":"Please enter an Institution Registry ID to add"});},"@VERSION@");
YUI.add("lang/request-wskey-view",function(a){a.Intl.add("request-wskey-view","",{"label":{"symbol":"Symbol","redirecturidescription":"If you are building an application that will utilize one of our OAuth 2 flows, enter the redirect URI that your web or mobile application will use to respond to and catch user logins. For more information, see our","singlePageWebApp":"Single-Page App (SPAs): JavaScript application that performs most of its user interface logic in a web browser, communicating with a web server primarily using APIs (e.g., AngularJS + Node.js, React).","commercialuser":"I am interested in commercial use of this web service","redirecturi":"Redirect URI","sandbox":"Sandbox","addInst":"Add","termsAgree":"I agree to the {displayName}","redirecturidescription2":"Access Token documentation.","approval":"Production keys will need approval. Sandbox keys will be created immediately.","create":"Create Request","production":"Production","comments":"What is the reason for this request?","opensocial":"This key will be used to to create WorldShare OpenSocial Apps","machineToMachineApp":"Machine-to-Machine (M2M) App: Non-interactive application, such as command-line tools, daemons, IoT devices, or services running on your back-end. Typically, you use this option if you have a service that requires access to an API.","symboldescription":"Be sure to include your library symbol, if you have one, to ensure expedited processing of your request","termsAgreeWorldShare":"I agree to the WorldShare Platform Developer","usage":"Usage","applicationType":"Select Application Type","termsConditions":"Terms and Conditions","regularWebApp":"Regular Web App: Traditional web application that performs most of its application logic on the server (e.g., Express.js, ASP.NET).","contextInstId":"Owning Institution","nativeApp":"Native App: Mobile or Desktop app that runs natively in a device (e.g., iOS, Android).","environment":"Environment","registryID":"Registry ID","services":"Services","multipleinstituions":"I am an OCLC Partner accessing data on behalf of libraries","wskeyName":"WSKey Name","unknownApp":"I Don't Know (please describe your application in reason for this request) "},"success2":"Click here to view key details.","success1":"Successfully created Sandbox key.","heading":"Request a WSKey","error":{"loadServices":"Error loading services","termsConditions":"You must select a Service and agree to all its Terms and Conditions"},"submitted1":"Successfully submitted request.","submitted2":"Click here to view status details."});},"@VERSION@");
YUI.add("cop-notify",function(a){var e={INIT:"init",STARTED:"started"},g=a.Lang,f="boundingBox",h="contentBox",b="closable",i="info",d="icon",c="notify-message";a.namespace("Platform.Notify").Message=a.Base.create(c,a.Widget,[a.WidgetChild],{BOUNDING_TEMPLATE:"<li/>",CONTENT_TEMPLATE:'<div class="alert" />',CLOSE_TEMPLATE:'<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>',ICON_TEMPLATE:"<span class='alert-icon'/>",initializer:function(j){this.get(f).setStyle("opacity",0);},renderUI:function(){var j=this.get(h);j.addClass("alert-"+this.get(d));if(this.get(b)){j.addClass("alert-dismissable");j.appendChild(this.CLOSE_TEMPLATE).on("click",this.close,this);}j.setContent(this.get("message"));},bindUI:function(){this._bindHover();},syncUI:function(){var k=this.get(f),j=this.get("timeout");if(j>0){this.timer=new a.Timer({length:j,repeatCount:1,callback:a.bind(this.close,this)});}k.show("fadeIn",{},function(l){});this._startTimer();if(this.get(d)){this.get(h).insert(this.ICON_TEMPLATE,0);}},_startTimer:function(){if(this.timer){this.timer.start();}},close:function(){if(this.timer){this.timer.stop();this.timer=null;}var j=this.get(f);j.hide("fadeOut",{},a.bind(function(){this.destroy();},this));},_bindHover:function(){var j=this.get(f);j.on("mouseenter",a.bind(function(k){if(this.timer){this.timer.pause();}},this));j.on("mouseleave",a.bind(function(k){if(this.timer){this.timer.resume();}},this));}},{ATTRS:{closable:{value:true,validator:g.isBoolean},message:{},timeout:{value:8000},icon:{validator:g.isString,setter:function(j){this.get(f).replaceClass(this.getClassName(d,this.get(d)||i),this.getClassName(d,j||i));return j;},value:i,lazyAdd:false}}});a.Platform.Notify=a.Base.create("notify",a.Widget,[a.WidgetParent,a.EventTarget],{CONTENT_TEMPLATE:"<ul/>",_childConfig:{},initializer:function(j){this.publish(e.INIT,{broadcast:1});this.publish(e.STARTED,{broadcast:1});this.fire(e.INIT);this._buildChildConfig();},syncUI:function(){this.fire(e.STARTED);},addMessage:function(l,k,j){k=k||i;if(k==="notice"||k==="ok"){k="success";}else{if(k==="error"){k="danger";}else{if(k==="alert"){k="warning";}else{if(k==="default"){k="info";}}}}this._buildChildConfig(l,k);if(j){return this.add(this._childConfig,j);}if(this.get("prepend")){return this.add(this._childConfig,0);}return this.add(this._childConfig);},addMessages:function(m){var n,k,j;for(n in m){if(g.isArray(m[n])){for(k=0,j=m[n].length;k<j;k++){this.addMessage(m[n][k],n);}}}},clearMessages:function(){this.removeAll();},_buildChildConfig:function(k,j){this._childConfig={closable:this.get(b),timeout:this.get("timeout"),message:k,icon:j};}},{ATTRS:{closable:{value:true,validator:g.isBoolean},defaultChildType:{value:a.Platform.Notify.Message},prepend:{value:false,validator:g.isBoolean},timeout:{value:8000}},EVENTS:e});},"@VERSION@",{requires:["base","anim","substitute","widget","widget-parent","widget-child","gallery-timer","event-mouseenter","transition","alert"],skinnable:true});
YUI.add("alert-plugin",function(h){var d=h.Lang,f=h.ClassNameManager,c=f.getClassName,b="alert-plugin",e=c(b,"container"),a=c(b,"global");function g(i){g.superclass.constructor.apply(this,arguments);}g.NAME="alertPlugin";g.NS="alerts";g.ATTRS={};h.extend(g,h.Plugin.Base,{alertsTemplate:"<div class='"+a+"'></div>",initializer:function(j){var k=this._node=j.host,i;k.addClass(e);i=h.Node.create(this.alertsTemplate);k.prepend(i);this.notify=new h.Platform.Notify({closable:"false",timeout:0});this.notify.render(i);this._notifyWidgets={};},destructor:function(){h.Object.each(this._notifyWidgets,function(j,i,k){k[i].destory();},this);this._notifyWidgets=null;},alert:function(){if(arguments.length>=2&&d.isString(arguments[0])){this.notify.addMessage(arguments[0],arguments[1],arguments[2]);}else{if(d.isObject(arguments[0])){if(arguments[0].value){this.notify.addMessage(arguments[0].value,arguments[0].type.toLowerCase());}else{this.notify.addMessages(arguments[0]);}}}},add:function(){g.prototype.alert.apply(this,arguments);this._scrollIntoView(this.notify.get("boundingBox"));},clear:function(){this.notify.clearMessages();for(var i in this._notifyWidgets){this._notifyWidgets[i].clearMessages();}},bind:function(m,l){var i=this._node,k;l=l||{};l.type=l.type||"error";h.Object.each(m,function(t,u,r){var q=u.replace(".","\\."),v=["#"+q+"\\.errors","."+q+"\\.errors"],p,s,n=i.one("."+q+","+"*[name="+q+"]");h.Array.each(v,function(x,w){var y=i.one(x);if(!p&&y){p=y;}});if(!p&&n){p=h.Node.create("<span/>").addClass(q+".errors");n.insert(p,"after");}if(p){var o=this._notifyWidgets[u];if(!o){this._notifyWidgets[u]=o=new h.Platform.Notify({closable:false,timeout:0}).render(p);}h.Array.each(d.isArray(t)?t:[t],function(x,w){o.addMessage(x,l.type);});}else{h.Array.each(d.isArray(t)?t:[t],function(x,w){this.notify.addMessage(x,l.type);},this);}s=n||p||this.notify.get("boundingBox");if(!k||s.get("offsetTop")<k.get("offsetTop")){k=s;}},this);if(this.notify.size()>0){var j=this.notify.get("boundingBox");if(!k||j.get("offsetTop")<=k.get("offsetTop")){k=j;}}if(k){this._scrollIntoView(k);}},_scrollIntoView:function(i){var j,k;j=i.get("offsetTop");k=j-i.get("docScrollY");if(k<0||k>=i.get("winHeight")){window.scrollTo(0,j-30);}i.focus();}});h.namespace("Plugin").Alert=g;},"@VERSION@",{requires:["plugin","alert","classnamemanager","cop-notify"],skinnable:true});
YUI.add("cop-base-view",function(e){var d,c=e.ClassNameManager,a=c.getClassName,b=e.Lang,g="base-view",f=".";e.namespace("Platform").BaseView=d=e.Base.create(g,e.View,[],{_titleTemplate:e.Handlebars.compile("{{#if title}}{{title}}{{#if wsp}} : [{{wsp}}]{{/if}}{{else}}{{wsp}}{{/if}}"),headingNode:null,initializer:function(i){i=i||{};var h=this,j=h.constructor;h._cssPrefix=j.CSS_PREFIX||a(j.NAME.toLowerCase());this.after("pageHeadingChange",this._onPageHeadingChange,this);this.after("pageTitleChange",this._onPageTitleChange,this);this._setDocumentTitle();},destructor:function(){},create:function(h){var h=d.superclass.create.apply(this,arguments);h.plug(e.Plugin.Alert);return h;},getClassName:function(){return a.apply(c,[this._cssPrefix].concat(e.Array(arguments),true));},insertLoadingIndicator:function(h,j){var i=e.Node.create(d.LOADING_INDICATOR).hide();h.insert(i,j);return i;},_onPageHeadingChange:function(i){var h,j;if(i.newVal!==i.prevVal){h=this.get("container");if(!h.inDoc()){this.headingNode=e.Node.create(b.sub("<h1>{pageTitle}</h1>",{pageTitle:i.newVal}));j=h.one(f+"yui3-alert-plugin-container");if(j){j.insert(this.headingNode,"after");}else{h.prepend(this.headingNode);}}}},_onPageTitleChange:function(h){if(h.newVal!==h.prevVal){this._setDocumentTitle(h.newVal);}},_setDocumentTitle:function(i){var j=e.config.doc,h=this.get("strings"),k={wsp:h.appName};k.title=i||"";if(j){j.title=this._titleTemplate(k);}}},{ATTRS:{pageHeading:{value:null},pageTitle:{value:null},strings:{value:{},validator:e.Lang.isObject}},LOADING_INDICATOR:"<div class='loading'></div>"});},"@VERSION@",{requires:["view","handlebars","alert-plugin"]});
YUI.add("base-view",function(b){function a(){a.superclass.constructor.apply(this,arguments);}b.namespace("WKM").BaseView=b.extend(a,b.Platform.BaseView,{_strings:{appName:"WSKey Management"},initializer:function(){this.set("strings",b.merge(this._strings,this.get("strings")));},handleError:function(d,h){var f="",c;try{f=b.JSON.parse(d.responseText);}catch(g){if(h){f={"errors":[h]};}else{f={"errors":["Unknown Error"]};}}c=this.get("container");if(c.alerts){if(f.errors){c.alerts.add({"error":f.errors});}if(f.fieldErrors){c.alerts.bind(f.fieldErrors);}}document.getElementsByClassName("create-btn")[0].disabled=false;}},{NAME:"base-view",ATTRS:{}});},"@VERSION@",{requires:["cop-base-view","intl","wskey-templates"],skinnable:false});
YUI.add("cop-modelsync-extension",function(b){function a(c){b.Do.after(this._prefixContextPathToUrl,this,"getURL");}a.prototype={_prefixContextPathToUrl:function(){var d=b.namespace("Platform.Env.App").contextPath||"",c;c=b.Do.currentRetVal;if(c.indexOf("/")!==0){c="/"+c;}return new b.Do.AlterReturn("URL prefixed with application context path",d+c);}};b.mix(a,b.ModelSync.REST,false,null,2);b.namespace("Platform.ModelSync").REST=a;},"@VERSION@",{requires:["model-sync-rest","event-custom"]});
YUI.add("wskeyrequest-model",function(b){b.namespace("WKM").WSKeyRequestModel=b.Base.create("wskeyrequest-model",b.Model,[b.Platform.ModelSync.REST],{root:"/requests"},{ATTRS:{id:{},requester:{setter:function(d){var c=new b.WKM.RequesterModel(d);return c;}},status:{},type:{},commercialUser:{},multipleInstitutions:{},comments:{},oclcSymbol:{},registryID:{},redirectURI:{},services:{setter:function(c){c.sort();return c;}},requestDate:{},updatedDate:{},updatedBy:{},ownerInstID:{},applicationType:{},wskey:{setter:function(d){var c=new b.WKM.WSKeyModel(d);return c;}}}});"use strict";var a;b.namespace("WKM").WSKeyRequestList=a=b.Base.create("wskeyrequest-list",b.ModelList,[b.Platform.ModelSync.REST],{model:b.WKM.WSKeyRequestModel,getURL:function(e,d){var c=b.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(d.instId){c=c+"?instId="+d.instId;}return c;},parse:function(c){var d=a.superclass.parse.apply(this,arguments);if(d.wskeyRequests){return d.wskeyRequests;}return d;}},{});"use strict";b.namespace("WKM").RequesterModel=b.Base.create("requester-model",b.Model,[],{},{ATTRS:{username:{},displayName:{},realm:{},authInstID:{}}});"use strict";b.namespace("WKM").WSKeyModel=b.Base.create("wskey-model",b.Model,[],{},{ATTRS:{id:{},secret:{}}});"use strict";b.namespace("WKM").WSKeyRequestByIdModel=b.Base.create("wskeyrequestbyid-model",b.Model,[b.Platform.ModelSync.REST],{root:"/requestByID"},{ATTRS:{id:{},requester:{setter:function(d){var c=new b.WKM.RequesterModel(d);return c;}},status:{},type:{},commercialUser:{},multipleInstitutions:{},comments:{},oclcSymbol:{},registryID:{},redirectURI:{},services:{setter:function(c){c.sort();return c;}},requestDate:{},updatedDate:{},updatedBy:{},ownerInstID:{},wskey:{setter:function(d){var c=new b.WKM.WSKeyModel(d);return c;}}}});"use strict";var a;b.namespace("WKM").WSKeyRequestListById=a=b.Base.create("wskeyrequestbyid-list",b.ModelList,[b.Platform.ModelSync.REST],{model:b.WKM.WSKeyRequestByIdModel,getURL:function(e,d){var c=b.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(d.requestId){c=c+"?requestId="+d.requestId;}return c;},parse:function(c){var d=a.superclass.parse.apply(this,arguments);if(d.wskeyRequests){return d.wskeyRequests;}return d;}},{});},"@VERSION@",{requires:["model","model-list","cop-modelsync-extension"],skinnable:false});
YUI.add("wskeyservice-model",function(b){b.namespace("WKM").WSKeyServiceModel=b.Base.create("wskeyservice-model",b.Model,[b.Platform.ModelSync.REST],{root:"/services"},{ATTRS:{id:{},displayName:{},documentationLink:{},sandboxInfo:{}}});"use strict";var a;b.namespace("WKM").WSKeyServiceList=a=b.Base.create("wskeyservice-list",b.ModelList,[b.Platform.ModelSync.REST],{model:b.WKM.WSKeyServiceModel,getURL:function(e,d){var c=b.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(d.type){c=c+"?type="+d.type;}return c;},parse:function(c){var d=a.superclass.parse.apply(this,arguments);if(d.wskeyServices){return d.wskeyServices;}return d;}},{});},"@VERSION@",{requires:["model","model-list","cop-modelsync-extension"],skinnable:false});
YUI.add("request-wskey-view",function(d){var b=d.Lang,c,a=d.WKM.Templates,e="request-wskey-view";d.namespace("WKM").RequestWSKeyView=c=d.Base.create(e,d.WKM.BaseView,[],{_template:a[e],events:{".create-btn":{click:"_onClickCreateBtn"},".instDropdownSelect":{change:"_oncontextInstIdChange"},".opensocial":{click:"_onClickOpensocial"},".service-checkbox":{click:"_onClickServiceCheckbox"}},_userInfo:null,_servicesTable:null,_requestList:null,_serviceList:null,_selectedType:"Sandbox",_selectedInstId:null,_defaultRedirectUri:"",_waitingIndicator:null,_nonEZProxyServiceCount:0,_TCsGroupCache:{groups:[]},_app:null,_appStrings:null,_userType:null,initializer:function(g){this._app=g.app;this._appStrings=g.appStrings;this._userInfo=g.userInfo;this._prodMode=g.prodMode;var f,h;if(g.opensocialUrl){this._defaultRedirectUri=g.opensocialUrl+"/gadgets/oauth2callback";}if(g.serviceList){this._serviceList=g.serviceList;}else{this._serviceList=new d.WKM.WSKeyServiceList();}this._requestList=new d.WKM.WSKeyRequestList();this._servicesTable=new d.DataTable({columns:[{key:"displayName",allowHTML:true,width:"10px",formatter:function(i){if(i.value=="EZProxy"){return"<input type='checkbox' class='service-checkbox EZ'/>";}else{return"<input type='checkbox' class='service-checkbox NON-EZ'/>";}}},{key:"displayName"}],sortBy:"displayName"});this._serviceList.after("load",this._onLoadServicesSuccess,this);this._serviceList.after("error",this._onLoadServicesError,this);},destructor:function(){var f=(new d.EventHandle(this._eventHandles)).detach();if(this._servicesTable){this._servicesTable.destroy();}this._waitingIndicator&&this._waitingIndicator.remove(true);this._waitingIndicator=null;},render:function(){var i=this.get("container"),h,l=this._prodMode?"Production":"Sandbox",g=this.get("strings"),j=this,f=this._userInfo.get("institutions"),m=this._userInfo.get("userType"),k;_userType=m;this.set("pageHeading",g.heading);this.set("pageTitle",g.heading);if(!i.inDoc()){i.addClass(this.getClassName("container"));i.append(this._template({strings:g}));this._servicesTable.render(i.one(".services"));d.on("contentready",function(){j._servicesTable.set("data",j._serviceList);},".services");this._waitingIndicator=this.insertLoadingIndicator(i.one(".services"),"before");if(this._serviceList.isEmpty()){i.one(".create-btn").setAttribute("disabled","disabled");}}this._selectedType=l;this._app.fillInstDropDown(i,f,m);if(f.size()>0){this._selectedInstId=f.item(0).getAttrs().id;}if(m!="ELDAP"){i.getDOMNode().getElementsByClassName("usageDiv")[0].style.display="none";}else{i.getDOMNode().getElementsByClassName("usageDiv")[0].style.display="inline-block";}return this;},_onSaveRequestsSuccess:function(j){var f=this.get("strings"),g=this.get("container"),h,i="";try{i=d.JSON.parse(j.response.responseText);}catch(j){}if(i.wskey&&i.wskey.id){h=d.substitute("{s1} <a href='/#/keys/manage/{id}'>{s2}</a>",{s1:f.success1,id:i.wskey.id,s2:f.success2});}else{h=d.substitute("{s1} <a href='/#/requests/show/{id}'>{s2}</a>",{s1:f.submitted1,id:i.id,s2:f.submitted2});}document.getElementsByClassName("create-btn")[0].disabled=false;g.alerts.add({success:[h]});},_onSaveRequestsError:function(f){this.handleError(f.response);},_onLoadServicesSuccess:function(g){var f=this.get("container");this._waitingIndicator.hide();f.one(".services").setStyle("visibility","");f.one(".create-btn").removeAttribute("disabled");},_onLoadServicesError:function(f){this._waitingIndicator.hide();this.handleError(f.response,this.get("strings").error.loadServices);},_onClickCreateBtn:function(){document.getElementsByClassName("create-btn")[0].disabled=true;var h=new d.WKM.WSKeyRequestModel(),g=this.get("container"),j=g.one("form"),f=this.get("strings"),i=d.one("#appTypeDiv input[name=applicationType]:checked").get("value"),m,l=0,k=[];g.alerts.clear();m=g.all(".terms-checkbox");m.each(function(n){if(n.get("checked")){l=l+1;}});if(l===0||l<m.size()){g.alerts.add(f.error.termsConditions,"error");document.getElementsByClassName("create-btn")[0].disabled=false;return;}h.after("save",this._onSaveRequestsSuccess,this);h.after("error",this._onSaveRequestsError,this);h.set("type",this._selectedType);m=this._servicesTable.get("srcNode").all("input");m.each(function(o,n){if(o.get("checked")){k.push(this._serviceList.item(n).get("id"));}},this);h.set("services",k);h.set("comments",j.one(".comments").get("value"));if(this._selectedType=="Production"&&this._selectedInstId){h.set("registryID",this._selectedInstId);}h.set("redirectURI",j.one(".redirectURI").get("value"));if(_userType=="ELDAP"){h.set("commercialUser",j.one(".commercialUser").get("checked"));}h.set("name",j.one(".wskeyName").get("value"));h.set("ownerInstID",this._selectedInstId);h.set("applicationType",i);this._requestList.create(h);},_oncontextInstIdChange:function(f){this._selectedInstId=f.target.get("value");},_onClickOpensocial:function(h){var f=this.get("container"),g=f.one(".redirectURI");if(h.target.get("checked")){g.set("value",this._defaultRedirectUri);g.setAttribute("readonly","");}else{g.set("value","");g.removeAttribute("readonly");}},_onClickServiceCheckbox:function(n){var j=this.get("container"),h=this._servicesTable.getRecord(n.target),f=this.get("strings");this._handleTermsAndConditionsLinks(h,n);if(n.target.get("checked")){if(h.get("displayName")=="EZProxy"){this._toggleAllButEZProxy(true);this._nonEZProxyServiceCount=0;}else{this._nonEZProxyServiceCount++;if(this._nonEZProxyServiceCount==1){this._toggleEZProxy(true);}}}else{if(h.get("displayName")=="EZProxy"){this._toggleAllButEZProxy(false);}else{this._nonEZProxyServiceCount--;if(this._nonEZProxyServiceCount==0){this._toggleEZProxy(false);}}}j.one("#termsConditions").all("label").remove();for(var k=0;k<this._TCsGroupCache.groups.length;k++){var m=this._TCsGroupCache.groups[k];var l=m.key;var g="";if(l=="http://www.oclc.org/developer/sites/default/files/terms_conditions/platform_devs_TCs_0.pdf"){g="WorldShare Platform Developer";}else{g=this._getGroupDisplayName(m);}j.one("#termsConditions").append(d.Lang.sub("<label class='pure-checkbox'><input type='checkbox' class='terms-checkbox'/>"+" {ag} <a href='{at}' target='_blank'>{tc}</a></label>",{ag:d.Lang.sub(f.label.termsAgree,{displayName:g}),at:l,tc:f.label.termsConditions}));
}},_handleTermsAndConditionsLinks:function(h,j){var g=h.get("termsLink"),f=h.get("additionalTermsLink"),k=this._groupContains(g),i;if(j.target.get("checked")){this._addToOrCreateGroup(h,g,k);if(f!==""){i=this._groupContains(f);this._addToOrCreateGroup(h,f,i);}}else{this._removeFromGroup(h,k);if(f!==""){i=this._groupContains(f);this._removeFromGroup(h,i);}}},_toggleEZProxy:function(h){var f=document.getElementsByClassName("EZ");for(var g=0;g<f.length;g++){f[g].checked=false;h?f[g].disabled=true:f[g].disabled=false;}},_toggleAllButEZProxy:function(h){var f=document.getElementsByClassName("NON-EZ");for(var g=0;g<f.length;g++){f[g].checked=false;h?f[g].disabled=true:f[g].disabled=false;}},_groupContains:function(h){var f=this._TCsGroupCache.groups;for(var g=0;g<f.length;g++){if(f[g].key==h){return g;}}return -1;},_addToOrCreateGroup:function(f,h,g){if(g==-1){this._TCsGroupCache.groups.push({key:h,members:[f.get("displayName")]});}else{this._TCsGroupCache.groups[g].members.push(f.get("displayName"));}},_removeFromGroup:function(f,g){if(g!=-1){var h=this._arrayContains(this._TCsGroupCache.groups[g].members,f.get("displayName"));if(h!=-1){this._TCsGroupCache.groups[g].members.splice(h,1);}}if(this._TCsGroupCache.groups[g].members.length==0){this._TCsGroupCache.groups.splice(g,1);}},_getGroupDisplayName:function(l){var j=[];var f="";for(var h=0;h<l.members.length;h++){if(this._arrayContains(j,l.members[h])==-1){j.push(l.members[h]);}}for(var g=0;g<j.length;g++){if(f==""){f+=j[g];}else{if(g==(j.length-1)){f+=", and "+j[g];}else{f+=", "+j[g];}}}return f;},_arrayContains:function(h,g){for(var f=0;f<h.length;f++){if(h[f]==g){return f;}}return -1;}},{ATTRS:{strings:{value:d.Intl.get(e)}}});},"@VERSION@",{requires:["base-view","datatable-scroll","datatable-sort","wskeyrequest-model","wskeyservice-model","substitute"],skinnable:true});
YUI.add("lang/show-requests-view",function(a){a.Intl.add("show-requests-view","",{"heading":"Requests","label":{"addInst":"Add","pending":"(Pending)","name":"Name","key":"Key","requester":"Requester","details":"Click on a row for more details","created":"Created","environment":"Environment","services":"Services","selectInstitution":"Select an Institution:","id":"ID","status":"Status"}});},"@VERSION@");
YUI.add("show-requests-view",function(d){var b=d.Lang,c,a=d.WKM.Templates,e="show-requests-view";d.namespace("WKM").ShowRequestsView=c=d.Base.create(e,d.WKM.BaseView,[],{_template:a[e],events:{".add-inst-btn":{click:"_onClickAddInstBtn"},".dt table tbody tr":{click:"_onClickRow"},"select":{change:"_onChangeInstSelect"}},_requestsTable:null,_requestList:null,_serviceList:null,_userInfo:null,_app:null,_appStrings:null,initializer:function(j){var g=this.get("strings"),h=this.get("container"),f,k,i=this;this._app=j.app;this._appStrings=j.appStrings;this._userInfo=j.userInfo;if(j.requestList){this._requestList=j.requestList;}else{this._requestList=new d.WKM.WSKeyRequestList();}if(j.serviceList){this._serviceList=j.serviceList;}else{this._serviceList=new d.WKM.WSKeyServiceList();}this._requestsTable=new d.DataTable({columns:[{label:g.label.id,key:"id",allowHTML:true,formatter:function(l){return"<a href='#'>"+l.value+"</a>";}},{label:g.label.name,key:"name",allowHTML:true,formatter:function(l){return"<a href='#'>"+l.value+"</a>";}},{label:g.label.key,key:"wskey",allowHTML:true,formatter:function(l){if(l.value.get("id")){return l.value.get("id").substring(0,35)+"...";}return g.label.pending;}},{label:g.label.requester,key:"requester",formatter:function(l){return l.value.get("displayName");}},{label:g.label.services,key:"services",allowHTML:true,formatter:function(l){return i._formatServices(l.value);}},{label:g.label.environment,key:"type"},{label:g.label.created,key:"requestDate",formatter:function(l){return l.value&&d.Date.format(new Date(parseInt(l.value)),{format:"%m/%d/%Y"});},emptyCellValue:""},{label:g.label.status,key:"status"}],sortBy:{requestDate:-1},data:this._requestList});},destructor:function(){var f=(new d.EventHandle(this._eventHandles)).detach();if(this._requestsTable){this._requestsTable.destroy();}},_formatServices:function(i){var h="",f,g=this;d.Array.each(i,function(j){f=g._serviceList.getById(j);if(f){h=h+",<br>"+f.get("displayName")+" ("+j+")";}else{h=h+",<br>Unknown&nbsp;("+j+")";}});return h.substring(5);},render:function(){var i=this.get("container"),h=this.get("strings"),j=i.one("form"),g,f=this._userInfo.get("institutions"),k=this._userInfo.get("userType");this.set("pageHeading",h.heading);this.set("pageTitle",h.heading);if(!i.inDoc()){i.addClass(this.getClassName("container"));i.append(this._template({strings:h}));this._requestsTable.render(i.one(".dt"));}this._app.fillInstDropDown(i,f,k);return this;},_onClickAddInstBtn:function(h){var f=this.get("container"),g=this;this._app.addInstToDropDown(f,function(){g._onChangeInstSelect();});},_onClickRow:function(h){var f=h.currentTarget.getAttribute("data-yui3-record"),g=this._requestList.getByClientId(f);d.fire("show-request",{id:g.get("id")});},_onChangeInstSelect:function(){var f,g=document.getElementById("instSelect");f=g.options[g.selectedIndex].value,oldRequestList=this._requestList;newRequestList=new d.WKM.WSKeyRequestList();newRequestList.load({instId:f},function(j){if(j){alert("error!");}else{oldRequestList.reset();for(var h=0;h<newRequestList.size();h++){oldRequestList.add(newRequestList.item(h));}}});},},{ATTRS:{strings:{value:d.Intl.get(e)}}});},"@VERSION@",{requires:["base-view","datatable","datatable-sort","datatype-date","wskeyrequest-model","wskeyservice-model"],skinnable:true});
YUI.add("lang/show-request-view",function(a){a.Intl.add("show-request-view","",{"heading":"Request","label":{"pending":"(Pending)","key":"Key","environment":"Environment","requester":"Requester","status":"Status","services":"Services","comments":"Registration Comments","details":"Click on key for more details"}});},"@VERSION@");
YUI.add("show-request-view",function(d){var b=d.Lang,c,a=d.WKM.Templates,e="show-request-view";d.namespace("WKM").ShowRequestView=c=d.Base.create(e,d.WKM.BaseView,[],{_template:a[e],events:{"#key":{click:"_onManageButton"}},_request:null,_serviceList:null,initializer:function(g){var f=this.get("strings");if(g.request){this._request=g.request;}else{this._request=new d.WKM.WSKeyRequestByIdModel();}if(g.serviceList){this._serviceList=g.serviceList;}else{this._serviceList=new d.WKM.WSKeyServiceList();}},destructor:function(){var f=(new d.EventHandle(this._eventHandles)).detach();},_formatServices:function(i){var h="",f,g=this;d.Array.each(i,function(j){f=g._serviceList.getById(j);if(f){h=h+",<br>"+f.get("displayName")+" ("+j+")";}else{h=h+",<br>Unknown&nbsp;("+j+")";}});return h.substring(5);},render:function(){var g=this.get("container"),f=this.get("strings"),i=this._request.get("wskey").get("id"),h;this.set("pageHeading",f.heading);this.set("pageTitle",f.heading);if(!g.inDoc()){g.addClass(this.getClassName("container"));g.append(this._template({strings:f}));h=g.one("#key");if(i){h.setHTML(i);}else{h.set("id","key-pending");h.setHTML(f.label.pending);h.set("title","");}g.one("#requester").setHTML(this._request.get("requester").get("displayName"));g.one("#status").setHTML(this._request.get("status"));g.one("#environment").setHTML(this._request.get("type"));g.one("#services").setHTML(this._formatServices(this._request.get("services")));g.one("#registrationComments").setHTML(this._request.get("comments"));}return this;},_onManageButton:function(f){d.fire("manage-wskey",{id:this._request.get("wskey").get("id")});}},{ATTRS:{strings:{value:d.Intl.get(e)}}});},"@VERSION@",{requires:["base-view","wskeyrequest-model","wskeyservice-model"],skinnable:true});
YUI.add("lang/manage-wskeys-view",function(a){a.Intl.add("manage-wskeys-view","",{"label":{"quotaCallError":"Error retrieving Quota information","reissue":"Reissue","filter":{"noRegistryId":"No Registry ID","text":"Filter by Registry ID:","all":"All"},"createdDate":"Created Date","keyNote":"Note: Keys not included in the table below fall under the institution level quota.","services":"Services","quotaExceededColon":"Quota Exceeded:","filterStatus":{"valid":"VALID","text":"Filter by Status:","invalid":"INVALID"},"environment":"Environment","blockedDueToQuota":"Blocked Due to Quota","apiUsage":"API Usage","selectInstitution":"Select an Institution:","wskey":"Wskey","apiUsageColon":"API Usage:","noQuotaConfigured":"No quota configured for this institution","reissueDialogText":"Please select how long (in days) until the current key is deactivated","instLevelQuota":"Institution Level Quota","name":"Name","expires":"Expires","cancel":"Cancel","details":"Click on a row for more details","quotaExceeded":"Quota Exceeded","key":"Key","registryid":"Registry ID","closeDialog":"Close","oclcSymbol":"OCLC Symbol","addInst":"Add","usageBlocked":"Usage Blocked"},"heading":"WSKeys"});},"@VERSION@");
YUI.add("wskey-model",function(b){b.namespace("WKM").WSKeyModel=b.Base.create("wskey-model",b.Model,[b.Platform.ModelSync.REST],{root:"/keys"},{ATTRS:{status:{},owner:{setter:function(d){var c=new b.WKM.UserModel(d);return c;}},createdDate:{},createdBy:{},oclcSymbol:{},expirationDate:{},updatedDate:{},updatedBy:{},params:{},services:{setter:function(d){var c=new b.WKM.ServiceList();c.add(d);c.comparator=function(e){return e.get("name").toLowerCase();};return c.sort();}},wskeyVersion:{},id:{},type:{},name:{}}});"use strict";var a;b.namespace("WKM").WSKeyList=a=b.Base.create("wskey-list",b.ModelList,[b.Platform.ModelSync.REST],{model:b.WKM.WSKeyModel,getURL:function(e,d){var c=b.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(d.instId){c=c+"?instId="+d.instId;}return c;},parse:function(c){var d=a.superclass.parse.apply(this,arguments);if(d.wskeys){return d.wskeys;}return d;}},{});"use strict";b.namespace("WKM").UserModel=b.Base.create("user-model",b.Model,[],{},{ATTRS:{name:{},realm:{}}});"use strict";b.namespace("WKM").ServiceModel=b.Base.create("service-model",b.Model,[],{},{ATTRS:{status:{},registeredDate:{},expirationDate:{},actions:{},name:{},isExpired:{}}});"use strict";var a;b.namespace("WKM").ServiceList=a=b.Base.create("service-list",b.ModelList,[],{model:b.WKM.ServiceModel},{});"use strict";b.namespace("WKM").WSKeyByIdModel=b.Base.create("wskeybyid-model",b.Model,[b.Platform.ModelSync.REST],{root:"/keysById"},{ATTRS:{status:{},user:{setter:function(d){var c=new b.WKM.UserModel(d);return c;}},createdDate:{},createdBy:{},oclcSymbol:{},expirationDate:{},updatedDate:{},updatedBy:{},params:{},services:{setter:function(d){var c=new b.WKM.ServiceList();c.add(d);c.comparator=function(e){return e.get("name").toLowerCase();};return c.sort();}},wskeyVersion:{},id:{},type:{},name:{},updateSecretFlag:{},updateNameFlag:{},updateRedirectFlag:{},corsDomain:{}}});"use strict";var a;b.namespace("WKM").WSKeyByIdList=a=b.Base.create("wskeybyid-list",b.ModelList,[b.Platform.ModelSync.REST],{model:b.WKM.WSKeyByIdModel,getURL:function(e,d){var c=b.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(d.wskeyId){c=c+"?wskeyId="+d.wskeyId;}return c;},parse:function(c){var d=a.superclass.parse.apply(this,arguments);if(d.wskeys){return d.wskeys;}return d;}},{});},"@VERSION@",{requires:["model","model-list","cop-modelsync-extension"],skinnable:false});
YUI.add("wskeysecret-model",function(a){a.namespace("WKM").WSKeySecretModel=a.Base.create("wskeysecret-model",a.Model,[a.Platform.ModelSync.REST],{root:"/secret",getURL:function(d,c){var b=a.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(c.wskey){b=b+"?wskey="+c.wskey;}return b;}},{ATTRS:{wskey:{},secret:{}}});"use strict";a.namespace("WKM").ResetSecretModel=a.Base.create("resetsecret-model",a.Model,[a.Platform.ModelSync.REST],{root:"/resetSecret",getURL:function(d,c){var b=a.Platform.ModelSync.REST.prototype.getURL.apply(this,arguments);if(c.wskey){b=b+"?wskey="+c.wskey;}return b;}},{ATTRS:{wskey:{},secret:{}}});},"@VERSION@",{requires:["model","cop-modelsync-extension"],skinnable:false});
